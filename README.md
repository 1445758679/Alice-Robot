这个代码不是我写的，我做的事情只是将源代码修改了部分，解决了我自己遇到的问题，之前很长一段时间CSDN的朋友问我要这份修改过的代码，现在我把它共享在这里，文档之类的已经比较详细。
